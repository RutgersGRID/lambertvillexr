var d=Object.defineProperty;var h=(o,s,t)=>s in o?d(o,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[s]=t;var i=(o,s,t)=>(h(o,typeof s!="symbol"?s+"":s,t),t);import{B as y,c as p}from"./component.decorator.a66a1cbe.js";import"./aframe-master.5ce7d00f.js";import"./test-helpers.473cda21.js";var v=Object.defineProperty,f=Object.getOwnPropertyDescriptor,u=(o,s,t,e)=>{for(var r=e>1?void 0:e?f(s,t):s,a=o.length-1,l;a>=0;a--)(l=o[a])&&(r=(e?l(s,t,r):l(r))||r);return e&&r&&v(s,t,r),r},c;let n=(c=class extends y{constructor(){super(...arguments);i(this,"isArMode",!1);i(this,"mutationObserver")}init(){var s,t;(s=this.el.sceneEl)==null||s.addEventListener("enter-vr",()=>{var e;(e=this.el.sceneEl)!=null&&e.is("ar-mode")&&(this.isArMode=!0,this.updateLayers())}),(t=this.el.sceneEl)==null||t.addEventListener("exit-vr",()=>{this.isArMode=!1,this.updateLayers()}),this.mutationObserver=new MutationObserver((e,r)=>{e.forEach(a=>{a.type=="childList"&&(console.log("mutation occur for ",a.target),this.updateLayers())})}),this.mutationObserver.observe(this.el,{childList:!0}),this.el.addEventListener("child-detached",()=>{this.updateLayers()}),this.updateLayers()}remove(){var s;(s=this.mutationObserver)==null||s.disconnect()}updateLayers(){const s=e=>{e.layers.disableAll(),this.data.layers.forEach(r=>e.layers.enable(r)),this.isArMode?this.data.arLayers.forEach(r=>e.layers.enable(r)):this.data.desktopLayers.forEach(r=>e.layers.enable(r)),e.children.forEach(r=>s(r))},t=e=>{if(console.log("set elem ",e.tagName," with layers ",this.data.layers),e.object3D)console.log("	element has object3D, proccessing"),s(e.object3D);else{console.log("	add loaded listener"),e.addEventListener("loaded",()=>{console.log("loaded procced"),t(e)});return}Array.from(e.childNodes).forEach(r=>{const a=r;console.log("	process child ",a.tagName),a.getAttribute("three-layer")||(console.log("		 child doesn't have three layer so recursing"),t(a))})};t(this.el)}},i(c,"schema",{layers:{type:"array"},arLayers:{type:"array"},desktopLayers:{type:"array"}}),c);n=u([p("three-layer")],n);export{n as ThreeLayerComopnent};
