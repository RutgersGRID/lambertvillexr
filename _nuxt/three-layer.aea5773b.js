var u=Object.defineProperty;var v=(r,e,t)=>e in r?u(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var d=(r,e,t)=>(v(r,typeof e!="symbol"?e+"":e,t),t);import{c as f,B as m}from"./component.decorator.a66a1cbe.js";import"./aframe-master.5ce7d00f.js";import"./test-helpers.473cda21.js";var p=Object.defineProperty,g=Object.getOwnPropertyDescriptor,E=(r,e,t,a)=>{for(var s=a>1?void 0:a?g(e,t):e,i=r.length-1,n;i>=0;i--)(n=r[i])&&(s=(a?n(e,t,s):n(s))||s);return a&&s&&p(e,t,s),s},h;let c=(h=class extends m{constructor(){super(...arguments);d(this,"isArMode",!1);d(this,"mutationObserver")}init(){var e,t;this.data.enterVr&&((e=this.el.sceneEl)==null||e.addEventListener("enter-vr",()=>{var a;(a=this.el.sceneEl)!=null&&a.is("ar-mode")&&(this.isArMode=!0,this.emitChanged())})),this.data.exitVr&&((t=this.el.sceneEl)==null||t.addEventListener("exit-vr",()=>{this.isArMode=!1,this.emitChanged()})),this.mutationObserver=new MutationObserver((a,s)=>{a.forEach(i=>{i.type=="childList"&&(this.tryTrackEntity(i.target),this.data.elemTreeChanged&&this.emitChanged())})}),this.tryTrackEntity(this.el),this.mutationObserver.observe(this.el,{childList:!0,subtree:this.data.recursive}),this.el.addEventListener("child-detached",()=>{this.emitChanged()})}tryTrackEntity(e){e.hasAttribute("change-detector-tracked")||(e.setAttribute("change-detector-tracked",!0),e.hasLoaded||e.addEventListener("loaded",()=>this.emitChanged()),this.data.object3DSet&&e.addEventListener("object3dset",()=>{this.emitChanged()}),this.data.play&&e.addEventListener("play",()=>this.emitChanged()),this.data.pause&&e.addEventListener("pause",()=>this.emitChanged()),this.data.componentChanged&&e.addEventListener("componentchanged",()=>this.emitChanged()),this.data.componentInitialized&&e.addEventListener("componentinitialized",()=>this.emitChanged()),this.data.componentRemoved&&e.addEventListener("componentremoved",()=>this.emitChanged()),this.data.schemaChanged&&e.addEventListener("schemachanged",()=>this.emitChanged()),this.data.stateAdded&&e.addEventListener("stateadded",()=>this.emitChanged()),this.data.stateRemoved&&e.addEventListener("stateremoved",()=>this.emitChanged()))}emitChanged(){this.el.emit(`detectorchanged__${this.id}`)}remove(){var e;(e=this.mutationObserver)==null||e.disconnect()}},d(h,"schema",{recursive:{default:!1},enterVr:{default:!1},exitVr:{default:!1},elemTreeChanged:{default:!1},componentChanged:{default:!1},componentInitialized:{default:!1},componentRemoved:{default:!1},object3DSet:{default:!1},pause:{default:!1},play:{default:!1},stateAdded:{default:!1},stateRemoved:{default:!1},schemaChanged:{default:!1}}),d(h,"multiple",!0),h);c=E([f("change-detector")],c);var L=Object.defineProperty,b=Object.getOwnPropertyDescriptor,y=(r,e,t,a)=>{for(var s=a>1?void 0:a?b(e,t):e,i=r.length-1,n;i>=0;i--)(n=r[i])&&(s=(a?n(e,t,s):n(s))||s);return a&&s&&L(e,t,s),s};const C=21;var l;let o=(l=class extends m{constructor(){super(...arguments);d(this,"isArMode",!1);d(this,"mutationObserver");d(this,"changeDetector")}init(){var e,t;this.el.setAttribute("change-detector__three-layer",{recursive:!0,object3DSet:!0}),this.changeDetector=this.el.getAttribute("change-detector__three-layer"),this.changeDetector&&(this.el.addEventListener("detectorchanged__three-layer",()=>{this.updateAllElemLayers()}),(e=this.el.sceneEl)==null||e.addEventListener("enter-vr",()=>{var a;(a=this.el.sceneEl)!=null&&a.is("ar-mode")&&(this.isArMode=!0,this.updateAllElemLayers())}),(t=this.el.sceneEl)==null||t.addEventListener("exit-vr",()=>{this.isArMode=!1,this.updateAllElemLayers()}),this.updateAllElemLayers())}updateLayers(e){e.disableAll(),e.enable(C),this.data.layers.forEach(t=>e.enable(t)),this.isArMode?this.data.arLayers.forEach(t=>e.enable(t)):this.data.desktopLayers.forEach(t=>e.enable(t))}updateAllElemLayers(){const e=a=>{this.updateLayers(a.layers),a.children.forEach(s=>{e(s)})},t=a=>{if(a.object3D&&e(a.object3D),a.hasAttribute("raycaster")){const s=a.components.raycaster.raycaster;this.updateLayers(s.layers)}Array.from(a.childNodes).forEach(s=>{const i=s;i.getAttribute("three-layer")||t(i)})};t(this.el)}},d(l,"schema",{layers:{type:"array"},arLayers:{type:"array"},desktopLayers:{type:"array"}}),l);o=y([f("three-layer")],o);export{o as ThreeLayerComopnent,C as aframeCameraLayer};
