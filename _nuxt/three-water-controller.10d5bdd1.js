var f=Object.defineProperty;var d=(r,e,t)=>e in r?f(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var n=(r,e,t)=>(d(r,typeof e!="symbol"?e+"":e,t),t);import{b as w}from"./aframe-master.5ce7d00f.js";import"./test-helpers.473cda21.js";import{s as v}from"./three.978d9ee7.js";var p;const y=(p=class{},n(p,"schema",{}),p);function L(r){const e=r.prototype,t={schema:r.schema},s=Object.getOwnPropertyNames(e);s.forEach(i=>{i!=="constructor"&&(t[i]=e[i])});const a=e.init;return t.init=function(){const i=new r;Object.getOwnPropertyNames(i).forEach(o=>{this[o]=i[o]}),s.forEach(o=>{const h=this[o];h._bindToAframe&&typeof h=="function"&&(this[o]=h.bind(this))}),a&&a.call(this)},t}function A(r){return function(e){w.registerSystem(r,L(e))}}var E=Object.defineProperty,b=Object.getOwnPropertyDescriptor,O=(r,e,t,s)=>{for(var a=s>1?void 0:s?b(e,t):e,i=r.length-1,c;i>=0;i--)(c=r[i])&&(a=(s?c(e,t,a):c(a))||a);return s&&a&&E(e,t,a),a};const l=AFRAME.THREE;var m;let u=(m=class extends y{constructor(){super(...arguments);n(this,"water");n(this,"camera");n(this,"plane");n(this,"underwater",!1);n(this,"currentWaterLevel",0);n(this,"waterLevelAnimation")}init(){var t;const e=this.el;this.water=e.querySelector("a-three-water")??void 0,this.camera=e.querySelector("[camera]")??void 0,this.plane=new l.Mesh(new l.PlaneGeometry(10,10),new l.MeshBasicMaterial({color:2573673,opacity:.5,transparent:!0,depthTest:!1})),v(this.plane,50),(t=this.camera)==null||t.setObject3D("tint",this.plane),this.plane.position.set(0,0,-.1),this.updateUnderwaterFX()}tick(e,t){var a;if(!this.camera)return;(a=this.water)==null||a.setAttribute("position",{x:0,y:this.currentWaterLevel,z:0});const s=this.currentWaterLevel>this.camera.getAttribute("position").y;s!=this.underwater&&(this.underwater=s,this.updateUnderwaterFX())}update(e){e.waterLevel!=this.data.waterLevel&&(this.waterLevelAnimation!=null&&this.waterLevelAnimation.completed&&w.ANIME.remove(this),this.waterLevelAnimation=AFRAME.ANIME({targets:this,currentWaterLevel:this.data.waterLevel,easing:"easeInOutQuad",duration:1e3}))}changeWaterLevel(e){}updateUnderwaterFX(){this.plane&&(this.plane.visible=this.underwater)}},n(m,"schema",{waterLevel:{default:-1}}),m);u=O([A("three-water-controller")],u);export{u as ThreeWaterControllerSystem};
